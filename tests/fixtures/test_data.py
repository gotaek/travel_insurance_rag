"""
í…ŒìŠ¤íŠ¸ ë°ì´í„° ë° í”½ìŠ¤ì²˜
"""

import pytest


@pytest.fixture
def sample_questions():
    """ìƒ˜í”Œ ì§ˆë¬¸ ë°ì´í„°"""
    return {
        "qa": [
            "ì—¬í–‰ìë³´í—˜ ë³´ì¥ ë‚´ìš©ì´ ë­ì•¼?",
            "ë³´í—˜ë£ŒëŠ” ì–¼ë§ˆì¸ê°€ìš”?",
            "ê°€ì… ì¡°ê±´ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?",
            "ë³´í—˜ ê¸°ê°„ì€ ì–¼ë§ˆë‚˜ ë˜ë‚˜ìš”?"
        ],
        "summary": [
            "ì—¬í–‰ìë³´í—˜ ì•½ê´€ì„ ìš”ì•½í•´ì£¼ì„¸ìš”",
            "ìƒí’ˆ ë‚´ìš©ì„ ê°„ë‹¨íˆ ì •ë¦¬í•´ì£¼ì„¸ìš”",
            "í•µì‹¬ ë‚´ìš©ì„ í•œëˆˆì— ë³´ì—¬ì£¼ì„¸ìš”",
            "ì „ì²´ ì•½ê´€ì„ ìš”ì•½í•´ì£¼ì„¸ìš”"
        ],
        "compare": [
            "DBì†í•´ë³´í—˜ê³¼ KBì†í•´ë³´í—˜ì˜ ì°¨ì´ì ì„ ë¹„êµí•´ì£¼ì„¸ìš”",
            "íœ´ëŒ€í’ˆ ê´€ë ¨ ì¡°í•­ì€ ì–´ë–»ê²Œ ë¼?",
            "ì—¬ëŸ¬ ë³´í—˜ ìƒí’ˆì˜ ë³´ì¥ ë‚´ìš©ì„ ë¹„êµí•´ì£¼ì„¸ìš”",
            "ê°œì¸ìš©í’ˆ ë³´ìƒ ê·œì •ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"
        ],
        "recommend": [
            "ì¼ë³¸ ì—¬í–‰ì— ì¶”ì²œí•˜ëŠ” ë³´í—˜ì€?",
            "ë‚˜ì—ê²Œ ì í•©í•œ íŠ¹ì•½ì„ ì¶”ì²œí•´ì£¼ì„¸ìš”",
            "ì–´ë–¤ ë³´í—˜ì´ ê°€ì¥ ì¢‹ì„ê¹Œìš”?",
            "2025ë…„ 3ì›” ì¼ë³¸ ë„ì¿„ ì—¬í–‰ì— ì¶”ì²œí•˜ëŠ” ë³´í—˜ì€?"
        ]
    }


@pytest.fixture
def web_search_questions():
    """ì›¹ ê²€ìƒ‰ì´ í•„ìš”í•œ ì§ˆë¬¸ë“¤"""
    return [
        "2025ë…„ 3ì›” ì¼ë³¸ ë„ì¿„ ì—¬í–‰ ë³´í—˜ ì¶”ì²œí•´ì£¼ì„¸ìš”",
        "í˜„ì¬ ë„ì¿„ì˜ ì•ˆì „ ìƒí™©ì€ ì–´ë–¤ê°€ìš”?",
        "ìµœì‹  ì—¬í–‰ ì œí•œ ì‚¬í•­ì„ ì•Œë ¤ì£¼ì„¸ìš”",
        "í˜„ì¬ ì¼ë³¸ì˜ ì½”ë¡œë‚˜ ìƒí™©ì€ ì–´ë–¤ê°€ìš”?"
    ]


@pytest.fixture
def edge_case_questions():
    """ì—£ì§€ ì¼€ì´ìŠ¤ ì§ˆë¬¸ë“¤"""
    return [
        "",
        "ì•ˆë…•í•˜ì„¸ìš”",
        "ë³´í—˜",
        "ì–´ë–»ê²Œ ì–´ë–»ê²Œ ì–´ë–»ê²Œ",
        "???",
        "123456789",
        "a" * 1000  # ë§¤ìš° ê¸´ ì§ˆë¬¸
    ]


@pytest.fixture
def expected_classifications():
    """ì˜ˆìƒ ë¶„ë¥˜ ê²°ê³¼"""
    return {
        "ì—¬í–‰ìë³´í—˜ ë³´ì¥ ë‚´ìš©ì´ ë­ì•¼?": {"intent": "qa", "needs_web": False},
        "íœ´ëŒ€í’ˆ ê´€ë ¨ ì¡°í•­ì€ ì–´ë–»ê²Œ ë¼?": {"intent": "compare", "needs_web": False},
        "ì¼ë³¸ ì—¬í–‰ì— ì¶”ì²œí•˜ëŠ” ë³´í—˜ì€?": {"intent": "recommend", "needs_web": True},
        "ì—¬í–‰ìë³´í—˜ ì•½ê´€ì„ ìš”ì•½í•´ì£¼ì„¸ìš”": {"intent": "summary", "needs_web": False},
        "DBì†í•´ë³´í—˜ê³¼ KBì†í•´ë³´í—˜ì˜ ì°¨ì´ì ì„ ë¹„êµí•´ì£¼ì„¸ìš”": {"intent": "compare", "needs_web": False}
    }


@pytest.fixture
def performance_benchmark_questions():
    """ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ìš© ì§ˆë¬¸ë“¤"""
    return [
        "ì—¬í–‰ìë³´í—˜ ë³´ì¥ ë‚´ìš©ì´ ë­ì•¼?",
        "íœ´ëŒ€í’ˆ ê´€ë ¨ ì¡°í•­ì€ ì–´ë–»ê²Œ ë¼?",
        "ì¼ë³¸ ì—¬í–‰ì— ì¶”ì²œí•˜ëŠ” ë³´í—˜ì€?",
        "ì—¬í–‰ìë³´í—˜ ì•½ê´€ì„ ìš”ì•½í•´ì£¼ì„¸ìš”",
        "DBì†í•´ë³´í—˜ê³¼ KBì†í•´ë³´í—˜ì˜ ì°¨ì´ì ì„ ë¹„êµí•´ì£¼ì„¸ìš”",
        "ë³´í—˜ë£ŒëŠ” ì–¼ë§ˆì¸ê°€ìš”?",
        "ê°€ì… ì¡°ê±´ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?",
        "ìƒí’ˆ ë‚´ìš©ì„ ê°„ë‹¨íˆ ì •ë¦¬í•´ì£¼ì„¸ìš”",
        "í•µì‹¬ ë‚´ìš©ì„ í•œëˆˆì— ë³´ì—¬ì£¼ì„¸ìš”",
        "ì—¬ëŸ¬ ë³´í—˜ ìƒí’ˆì˜ ë³´ì¥ ë‚´ìš©ì„ ë¹„êµí•´ì£¼ì„¸ìš”"
    ] * 5  # 50ê°œ ì§ˆë¬¸


@pytest.fixture
def websearch_test_data():
    """ì›¹ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ìš© ë°ì´í„°"""
    return {
        "mock_tavily_response": {
            "results": [
                {
                    "url": "https://www.dbinsu.co.kr/travel-insurance",
                    "title": "DBì†í•´ë³´í—˜ ì—¬í–‰ìë³´í—˜ ë³´ì¥ë‚´ìš©",
                    "content": "í•´ì™¸ì—¬í–‰ë³´í—˜ì˜ ìƒì„¸í•œ ë³´ì¥ë‚´ìš©ì„ ì•ˆë‚´í•©ë‹ˆë‹¤. ì˜ë£Œë¹„, íœ´ëŒ€í’ˆ, ì—¬í–‰ì§€ì—° ë“± ë‹¤ì–‘í•œ ìœ„í—˜ì„ ë³´ì¥í•©ë‹ˆë‹¤.",
                    "score": 0.85
                },
                {
                    "url": "https://www.kbinsure.co.kr/products/travel",
                    "title": "KBì†í•´ë³´í—˜ ì—¬í–‰ìë³´í—˜ ìƒí’ˆì•ˆë‚´",
                    "content": "KBì†í•´ë³´í—˜ì˜ ì—¬í–‰ìë³´í—˜ ìƒí’ˆì— ëŒ€í•œ ìƒì„¸ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë³´í—˜ë£Œ, ê°€ì…ì¡°ê±´, ë³´ì¥ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”.",
                    "score": 0.82
                },
                {
                    "url": "https://www.naver.com/travel-insurance-guide",
                    "title": "ì—¬í–‰ìë³´í—˜ ê°€ì´ë“œ - ë„¤ì´ë²„",
                    "content": "ì—¬í–‰ìë³´í—˜ ì„ íƒ ê°€ì´ë“œì™€ ë¹„êµ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì—¬í–‰ ëª©ì ì— ë§ëŠ” ë³´í—˜ì„ ì„ íƒí•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.",
                    "score": 0.75
                }
            ]
        },
        "domain_test_urls": {
            "insurance_sites": [
                "https://www.dbinsu.co.kr/travel-insurance",
                "https://www.kbinsure.co.kr/products/travel",
                "https://www.samsungfire.com/insurance/travel",
                "https://www.hyundai.com/insurance/travel"
            ],
            "government_sites": [
                "https://www.fss.or.kr/insurance/travel",
                "https://www.kdi.re.kr/research/travel-insurance",
                "https://www.korea.kr/policy/travel",
                "https://www.visitkorea.or.kr/travel-info"
            ],
            "portal_sites": [
                "https://www.naver.com/travel-insurance",
                "https://www.daum.net/insurance/travel",
                "https://www.kakao.com/insurance"
            ],
            "other_sites": [
                "https://www.example.com/travel-insurance",
                "https://www.unknown-site.com/insurance"
            ]
        },
        "relevance_test_cases": [
            {
                "title": "ì—¬í–‰ìë³´í—˜ ë³´ì¥ë‚´ìš© ë° ë³´í—˜ë£Œ ì•ˆë‚´",
                "content": "í•´ì™¸ì—¬í–‰ë³´í—˜ì˜ ë³´ì¥ë‚´ìš©ê³¼ ë³´í—˜ë£Œì— ëŒ€í•œ ìƒì„¸ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.",
                "question": "ì—¬í–‰ìë³´í—˜ ë³´ì¥ë‚´ìš©ì´ ë­ì•¼?",
                "expected_score_range": (0.7, 1.0)
            },
            {
                "title": "ì¼ë°˜ ë‰´ìŠ¤ ê¸°ì‚¬",
                "content": "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ë§‘ìŠµë‹ˆë‹¤. ê²½ì œ ë‰´ìŠ¤ì…ë‹ˆë‹¤.",
                "question": "ì—¬í–‰ìë³´í—˜ ë³´ì¥ë‚´ìš©ì´ ë­ì•¼?",
                "expected_score_range": (0.0, 0.3)
            },
            {
                "title": "í•´ì™¸ì—¬í–‰ ê°€ì´ë“œ",
                "content": "ì¼ë³¸ ì—¬í–‰ì„ ìœ„í•œ ì¤€ë¹„ì‚¬í•­ê³¼ ê´€ê´‘ì§€ ì •ë³´",
                "question": "ì¼ë³¸ ì—¬í–‰ ë³´í—˜ ì¶”ì²œ",
                "expected_score_range": (0.3, 0.7)
            }
        ]
    }


@pytest.fixture
def websearch_edge_cases():
    """ì›¹ ê²€ìƒ‰ ì—£ì§€ ì¼€ì´ìŠ¤"""
    return {
        "empty_questions": ["", "   ", "\n", "\t"],
        "very_long_questions": ["ì—¬í–‰ìë³´í—˜" * 1000],
        "special_characters": ["???", "!!!", "@@@", "###", "$$$"],
        "numbers_only": ["123456789", "000000000"],
        "mixed_languages": ["ì—¬í–‰ìë³´í—˜ travel insurance", "ë³´í—˜ insurance ä¿é™º"],
        "unicode_questions": ["ì—¬í–‰ìë³´í—˜ ğŸ–ï¸ âœˆï¸", "ë³´í—˜ë£Œ ğŸ’° ğŸ’³"]
    }
